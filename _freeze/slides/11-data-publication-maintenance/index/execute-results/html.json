{
  "hash": "3d7a7a8541285749723bdbde67ce89ad",
  "result": {
    "markdown": "---\ntitle: Packaging Data; Publication and Maintenance\nsubtitle: Advanced R\nauthor: \n  - name: Heather Turner and Ella Kaye\n  - name: Department of Statistics, University of Warwick\ntitle-slide-attributes:\n  data-background-color: \"#552D62\"\ndate: 2023-06-21\ndate-format: long\nformat: \n  warwickpres-revealjs:\n    execute:\n      echo: true\n      code-overflow: wrap\n---\n\n\n## Overview\n\n- Packaging data\n- ...\n\n# Packaging data {.inverse}\n\n## Including data\n\nThere are 3 types of data we might want to include:\n\n- Exported data for the user to access: put in `/data`\n- Internal data for functions to access: put in `/R/sysdata.rda`\n- Raw data: put in `/inst/extdata`\n\n## Exported data\n\nThe data should be saved in `/data` as an `.rda` (or `.RData`) file.\n\n`usethis::use_data()` will do this for you, as well as a few other necessary steps:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nletter_indices <- data.frame(letter = letters, index = seq_along(letters))\nusethis::use_data(letter_indices)\n```\n:::\n\n\n```\n✔ Adding 'R' to Depends field in DESCRIPTION\n✔ Creating 'data/'\n✔ Setting LazyData to 'true' in 'DESCRIPTION'\n✔ Saving 'letter_indices' to 'data/letter_indices.rda'\n• Document your data (see 'https://r-pkgs.org/data.html')\n```\n\n. . .\n\n:::{.callout-note}\nFor larger datasets, you can try changing the `compress` argument to get the best compression.\n:::\n\n## Provenance\n\nOften the data that you want to make accessible to the users is one you have created with an R script -- either from scratch or from a raw data set.\n\nIt's a good idea to put the R script and any corresponding raw data in `/data-raw`.\n\n`usethis::use_data_raw(\"dataname\")` will set this up:\n\n - Create `/data-raw`\n - Add `/data-raw/dataname.R` for you to add the code needed to create the data\n - Add `^data-raw$` to `.Rbuildignore` as it does not need to be included in the actual package.\n\nYou should add any raw data files (e.g. `.csv` files) to `/data-raw`.\n\n## Documenting Data\n\nDatasets in `/data` are always exported, so **must** be documented.\n\nTo document a dataset, we must have an `.R` script in `/R` that contains a Roxygen block above the name of the dataset.\n\nAs with functions, you can choose how to arrange this, e.g. in one combined `/R/data.R` or in a separate R file for each dataset.\n\n## Example: letter_indices\n\n```\n#' Letters of the Roman Alphabet with Indices\n#'\n#' A dataset of lower-case letters of the Roman alphabet and their \n#' numeric index from a = 1 to z = 26.\n#'\n#' @format A data frame with 26 rows and 2 variables:\n#' \\describe{\n#'   \\item{letter}{The letter as a character string.}\n#'   \\item{index}{The corresponding numeric index.}\n#' }\n\"letter_indices\"\n```\n\n`#' @ examples` can be used here too.\n\n## Data source\n\nFor collected data, the (original) source should be documented with `#' @source`.\n\nThis should either be a url, e.g.\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#' @source \\url{http://www.diamondse.info/}\n```\n:::\n\n(alternatively `\\href{DiamondSearchEngine}{http://www.diamondse.info/}`), or a reference, e.g.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#' @source Henderson and Velleman (1981), Building multiple  \n#' #' regression models interactively. *Biometrics*, **37**, 391–411.\n```\n:::\n\n\n## Internal data\n\nSometimes functions need access to reference data, e.g. constants or look-up tables, that don't need to be shared with users.\n\nThese objects should be saved in a single `R/sysdata.rda` file.\n\nThis can be done with `use_data(..., internal = TRUE)`, e.g.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nx <- sample(1000)\nusethis::use_data(x, mtcars, internal = TRUE)\n```\n:::\n\n\nThe generating code and any raw data can be put in `/data-raw`.\n\nAs the objects are not exported, they don't need to be documented.\n\n## Raw data\n\nSometimes you want to include raw data, to use in examples or vignettes.\n\nThese files can be any format and should be added directly into `/inst/extdata`.\n\nWhen the package is installed, these files will be copied to the `extdata` directory and their path on your system can be found as follows:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsystem.file(\"extdata\", \"mtcars.csv\", package = \"readr\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"/Users/u2175871/Library/R/arm64/4.3/library/readr/extdata/mtcars.csv\"\n```\n:::\n:::\n\n\n## Your turn\n\n1. Run `usethis::use_data_raw(\"farm_animals\")`.\n2. In the script `data-raw/farm_animals.R` write some code to create a small data frame with the names of farm animals and the sound they make.\n3. Run all the code (including the already-present call to `usethis::use_data()`) to create the data and save it in `/data`.\n4. Add an `R/farm_animals.R` script and add some roxygen comments to document the function.\n5. Run `devtools::document()` to create the documentation for the `farm_animals` data. Preview the documentation to check it.\n6. Commit all the changes to your repo.\n\n# Publication {.inverse}\n\n# Maintenance {.inverse}\n\n## `usethis::use_upkeep_issue()`\n\nWRITE CONTENT FOR THIS SLIDE\n\n\n\n# End matter {.inverse}\n\n## References\n\nWickham, H and Bryan, J, _R Packages_ (2nd edn, in progress), https://r-pkgs.org.\n\nR Core Team, _Writing R Extensions_, https://cran.r-project.org/doc/manuals/r-release/R-exts.html\n\n## License\n\nLicensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License ([CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/){target=\"_blank\"}).\n\n\n```{=html}\n<!-- needs to be last chunk of presentation otherwise creates an extra slide -->\n<!-- requires Quarto v1.3 -->\n<!-- tint80 for border, tint20 for title -->\n<!-- this should hopefully no longer be necessary in Quarto 1.4 -->\n<!-- https://github.com/quarto-dev/quarto-cli/issues/5038 -->\n<style type=\"text/css\">\ndiv.callout-note {\n  border-left-color: #336695 !important;\n}\n\ndiv.callout-note.callout-style-default .callout-title {\n  background-color: #CCD9E4 !important;\n}\n\ndiv.callout-caution {\n  border-left-color: #AE4240 !important;\n}\n\ndiv.callout-caution.callout-style-default .callout-title {\n  background-color: #ebd0cf !important;\n}\n\ndiv.callout-tip {\n  border-left-color: #618157 !important;\n}\n\ndiv.callout-tip.callout-style-default .callout-title {\n  background-color: #d8e0d5 !important;\n}\n\ndiv.callout-important {\n  border-left-color: #775781 !important;\n}\n\ndiv.callout-important.callout-style-default .callout-title {\n  background-color: #ddd5e0 !important;\n}\n\ndiv.callout-warning {\n  border-left-color: #956133 !important;\n}\n\ndiv.callout-warning.callout-style-default .callout-title {\n  background-color: #e4d8cc !important;\n}\n</style>\n```\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}